<div class="ibox-content">
  <h5>Derniers messages par annonce</h5>
  <table class="table table-hover">
    <thead class="thead-light">
      <tr>
        <th>Conversations</th>
      </tr>
    </thead>
    <tbody>
      <!-- Parcourir les annonces -->
      <tr *ngFor="let annonce of annonces">
        <td>
          <!-- Parcourir les messages regroupés -->
          <div *ngFor="let item of lastMessages">
            <!-- Afficher le message s'il correspond à l'annonce actuelle ET si l'utilisateur m1 est le sender OU le receiver -->
            <div *ngIf="item.message.annonce.id === annonce.id &&
                         (item.message.sender.id === m1 || item.message.receiver.id === m1)">
              <a [routerLink]="['/msg', annonce.id, item.message.receiver.id]" class="message-link">
                <div class="message-header justify-content-between">
                  <strong style="font-size: 15px;">
                    {{ item.message.sender.username }} &mdash; {{ item.message.receiver.username }}
                  </strong>
                  <span class="badge badge-info">{{ annonce.titre }}</span>
                </div>
                <div class="message-content">
                  {{ item.message.content | slice: 0:50 }}...
                </div>
              </a>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
